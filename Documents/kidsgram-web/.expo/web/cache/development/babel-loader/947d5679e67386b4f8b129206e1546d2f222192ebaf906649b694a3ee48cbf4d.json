{"ast":null,"code":"function _createForOfIteratorHelperLoose(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (it) return (it = it.call(o)).next.bind(it); if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nimport { isJest } from \"./PlatformChecker\";\nimport { runOnUI } from \"./threads\";\nimport { isSharedValue } from \"./utils\";\nvar IS_JEST = isJest();\nvar _worklet_10153940359385_init_data = {\n  code: \"function createMapperRegistry() {\\n  const {\\n    IS_JEST,\\n    isSharedValue\\n  } = this._closure;\\n  const mappers = new Map();\\n  let sortedMappers = [];\\n  let runRequested = false;\\n  let processingMappers = false;\\n  function updateMappersOrder() {\\n    const pre = new Map();\\n    mappers.forEach(function (mapper) {\\n      if (mapper.outputs) {\\n        for (const output of mapper.outputs) {\\n          const preMappers = pre.get(output);\\n          if (preMappers === undefined) {\\n            pre.set(output, [mapper]);\\n          } else {\\n            preMappers.push(mapper);\\n          }\\n        }\\n      }\\n    });\\n    const visited = new Set();\\n    const newOrder = [];\\n    function dfs(mapper) {\\n      visited.add(mapper);\\n      for (const input of mapper.inputs) {\\n        const preMappers = pre.get(input);\\n        if (preMappers) {\\n          for (const preMapper of preMappers) {\\n            if (!visited.has(preMapper)) {\\n              dfs(preMapper);\\n            }\\n          }\\n        }\\n      }\\n      newOrder.push(mapper);\\n    }\\n    mappers.forEach(function (mapper) {\\n      if (!visited.has(mapper)) {\\n        dfs(mapper);\\n      }\\n    });\\n    sortedMappers = newOrder;\\n  }\\n  function mapperRun() {\\n    runRequested = false;\\n    if (processingMappers) {\\n      return;\\n    }\\n    processingMappers = true;\\n    if (mappers.size !== sortedMappers.length) {\\n      updateMappersOrder();\\n    }\\n    for (const mapper of sortedMappers) {\\n      if (mapper.dirty) {\\n        mapper.dirty = false;\\n        mapper.worklet();\\n      }\\n    }\\n    processingMappers = false;\\n  }\\n  function maybeRequestUpdates() {\\n    if (IS_JEST) {\\n      mapperRun();\\n    } else if (!runRequested) {\\n      if (processingMappers) {\\n        requestAnimationFrame(mapperRun);\\n      } else {\\n        queueMicrotask(mapperRun);\\n      }\\n      runRequested = true;\\n    }\\n  }\\n  function extractInputs(inputs, resultArray) {\\n    if (Array.isArray(inputs)) {\\n      for (const input of inputs) {\\n        input && extractInputs(input, resultArray);\\n      }\\n    } else if (isSharedValue(inputs)) {\\n      resultArray.push(inputs);\\n    } else if (Object.getPrototypeOf(inputs) === Object.prototype) {\\n      for (const element of Object.values(inputs)) {\\n        element && extractInputs(element, resultArray);\\n      }\\n    }\\n    return resultArray;\\n  }\\n  return {\\n    start: function (mapperID, worklet, inputs, outputs) {\\n      const mapper = {\\n        id: mapperID,\\n        dirty: true,\\n        worklet: worklet,\\n        inputs: extractInputs(inputs, []),\\n        outputs: outputs\\n      };\\n      mappers.set(mapper.id, mapper);\\n      sortedMappers = [];\\n      for (const sv of mapper.inputs) {\\n        sv.addListener(mapper.id, function () {\\n          mapper.dirty = true;\\n          maybeRequestUpdates();\\n        });\\n      }\\n      maybeRequestUpdates();\\n    },\\n    stop: function (mapperID) {\\n      const mapper = mappers.get(mapperID);\\n      if (mapper) {\\n        mappers.delete(mapper.id);\\n        sortedMappers = [];\\n        for (const sv of mapper.inputs) {\\n          sv.removeListener(mapper.id);\\n        }\\n      }\\n    }\\n  };\\n}\",\n  location: \"C:\\\\Users\\\\GGPC\\\\Documents\\\\kidsgram-web\\\\node_modules\\\\react-native-reanimated\\\\lib\\\\module\\\\reanimated2\\\\mappers.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"createMapperRegistry\\\",\\\"IS_JEST\\\",\\\"isSharedValue\\\",\\\"_closure\\\",\\\"mappers\\\",\\\"Map\\\",\\\"sortedMappers\\\",\\\"runRequested\\\",\\\"processingMappers\\\",\\\"updateMappersOrder\\\",\\\"pre\\\",\\\"forEach\\\",\\\"mapper\\\",\\\"outputs\\\",\\\"output\\\",\\\"preMappers\\\",\\\"get\\\",\\\"undefined\\\",\\\"set\\\",\\\"push\\\",\\\"visited\\\",\\\"Set\\\",\\\"newOrder\\\",\\\"dfs\\\",\\\"add\\\",\\\"input\\\",\\\"inputs\\\",\\\"preMapper\\\",\\\"has\\\",\\\"mapperRun\\\",\\\"size\\\",\\\"length\\\",\\\"dirty\\\",\\\"worklet\\\",\\\"maybeRequestUpdates\\\",\\\"requestAnimationFrame\\\",\\\"queueMicrotask\\\",\\\"extractInputs\\\",\\\"resultArray\\\",\\\"Array\\\",\\\"isArray\\\",\\\"Object\\\",\\\"getPrototypeOf\\\",\\\"prototype\\\",\\\"element\\\",\\\"values\\\",\\\"start\\\",\\\"mapperID\\\",\\\"id\\\",\\\"sv\\\",\\\"addListener\\\",\\\"stop\\\",\\\"delete\\\",\\\"removeListener\\\"],\\\"sources\\\":[\\\"C:/Users/GGPC/Documents/kidsgram-web/node_modules/react-native-reanimated/lib/module/reanimated2/mappers.js\\\"],\\\"mappings\\\":\\\"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\\\"}\"\n};\nexport var createMapperRegistry = function () {\n  var _e = [new global.Error(), -3, -27];\n  var _f = function _f() {\n    var mappers = new Map();\n    var sortedMappers = [];\n    var runRequested = false;\n    var processingMappers = false;\n    function updateMappersOrder() {\n      var pre = new Map();\n      mappers.forEach(function (mapper) {\n        if (mapper.outputs) {\n          for (var _iterator = _createForOfIteratorHelperLoose(mapper.outputs), _step; !(_step = _iterator()).done;) {\n            var output = _step.value;\n            var preMappers = pre.get(output);\n            if (preMappers === undefined) {\n              pre.set(output, [mapper]);\n            } else {\n              preMappers.push(mapper);\n            }\n          }\n        }\n      });\n      var visited = new Set();\n      var newOrder = [];\n      function dfs(mapper) {\n        visited.add(mapper);\n        for (var _iterator2 = _createForOfIteratorHelperLoose(mapper.inputs), _step2; !(_step2 = _iterator2()).done;) {\n          var input = _step2.value;\n          var preMappers = pre.get(input);\n          if (preMappers) {\n            for (var _iterator3 = _createForOfIteratorHelperLoose(preMappers), _step3; !(_step3 = _iterator3()).done;) {\n              var preMapper = _step3.value;\n              if (!visited.has(preMapper)) {\n                dfs(preMapper);\n              }\n            }\n          }\n        }\n        newOrder.push(mapper);\n      }\n      mappers.forEach(function (mapper) {\n        if (!visited.has(mapper)) {\n          dfs(mapper);\n        }\n      });\n      sortedMappers = newOrder;\n    }\n    function mapperRun() {\n      runRequested = false;\n      if (processingMappers) {\n        return;\n      }\n      processingMappers = true;\n      if (mappers.size !== sortedMappers.length) {\n        updateMappersOrder();\n      }\n      for (var _iterator4 = _createForOfIteratorHelperLoose(sortedMappers), _step4; !(_step4 = _iterator4()).done;) {\n        var mapper = _step4.value;\n        if (mapper.dirty) {\n          mapper.dirty = false;\n          mapper.worklet();\n        }\n      }\n      processingMappers = false;\n    }\n    function maybeRequestUpdates() {\n      if (IS_JEST) {\n        mapperRun();\n      } else if (!runRequested) {\n        if (processingMappers) {\n          requestAnimationFrame(mapperRun);\n        } else {\n          queueMicrotask(mapperRun);\n        }\n        runRequested = true;\n      }\n    }\n    function extractInputs(inputs, resultArray) {\n      if (Array.isArray(inputs)) {\n        for (var _iterator5 = _createForOfIteratorHelperLoose(inputs), _step5; !(_step5 = _iterator5()).done;) {\n          var input = _step5.value;\n          input && extractInputs(input, resultArray);\n        }\n      } else if (isSharedValue(inputs)) {\n        resultArray.push(inputs);\n      } else if (Object.getPrototypeOf(inputs) === Object.prototype) {\n        for (var _i = 0, _Object$values = Object.values(inputs); _i < _Object$values.length; _i++) {\n          var element = _Object$values[_i];\n          element && extractInputs(element, resultArray);\n        }\n      }\n      return resultArray;\n    }\n    return {\n      start: function start(mapperID, worklet, inputs, outputs) {\n        var mapper = {\n          id: mapperID,\n          dirty: true,\n          worklet: worklet,\n          inputs: extractInputs(inputs, []),\n          outputs: outputs\n        };\n        mappers.set(mapper.id, mapper);\n        sortedMappers = [];\n        for (var _iterator6 = _createForOfIteratorHelperLoose(mapper.inputs), _step6; !(_step6 = _iterator6()).done;) {\n          var sv = _step6.value;\n          sv.addListener(mapper.id, function () {\n            mapper.dirty = true;\n            maybeRequestUpdates();\n          });\n        }\n        maybeRequestUpdates();\n      },\n      stop: function stop(mapperID) {\n        var mapper = mappers.get(mapperID);\n        if (mapper) {\n          mappers.delete(mapper.id);\n          sortedMappers = [];\n          for (var _iterator7 = _createForOfIteratorHelperLoose(mapper.inputs), _step7; !(_step7 = _iterator7()).done;) {\n            var sv = _step7.value;\n            sv.removeListener(mapper.id);\n          }\n        }\n      }\n    };\n  };\n  _f._closure = {\n    IS_JEST: IS_JEST,\n    isSharedValue: isSharedValue\n  };\n  _f.__initData = _worklet_10153940359385_init_data;\n  _f.__workletHash = 10153940359385;\n  _f.__stackDetails = _e;\n  _f.__version = \"3.3.0\";\n  return _f;\n}();\nvar MAPPER_ID = 9999;\nvar _worklet_10884867408878_init_data = {\n  code: \"function anonymous() {\\n  const {\\n    createMapperRegistry,\\n    mapperID,\\n    worklet,\\n    inputs,\\n    outputs\\n  } = this._closure;\\n  let mapperRegistry = global.__mapperRegistry;\\n  if (mapperRegistry === undefined) {\\n    mapperRegistry = global.__mapperRegistry = createMapperRegistry();\\n  }\\n  mapperRegistry.start(mapperID, worklet, inputs, outputs);\\n}\",\n  location: \"C:\\\\Users\\\\GGPC\\\\Documents\\\\kidsgram-web\\\\node_modules\\\\react-native-reanimated\\\\lib\\\\module\\\\reanimated2\\\\mappers.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"anonymous\\\",\\\"createMapperRegistry\\\",\\\"mapperID\\\",\\\"worklet\\\",\\\"inputs\\\",\\\"outputs\\\",\\\"_closure\\\",\\\"mapperRegistry\\\",\\\"global\\\",\\\"__mapperRegistry\\\",\\\"undefined\\\",\\\"start\\\"],\\\"sources\\\":[\\\"C:/Users/GGPC/Documents/kidsgram-web/node_modules/react-native-reanimated/lib/module/reanimated2/mappers.js\\\"],\\\"mappings\\\":\\\"AAuKU,SAAAA,SAAMA,CAAA;EAAA;IAAAC,oBAAA;IAAAC,QAAA;IAAAC,OAAA;IAAAC,MAAA;IAAAC;EAAA,SAAAC,QAAA;EACZ,IAAIC,cAAc,GAAGC,MAAM,CAACC,gBAAgB;EAC5C,IAAIF,cAAc,KAAKG,SAAS,EAAE;IAChCH,cAAc,GAAGC,MAAM,CAACC,gBAAgB,GAAGR,oBAAoB,CAAC,CAAC;EACnE;EACAM,cAAc,CAACI,KAAK,CAACT,QAAQ,EAAEC,OAAO,EAAEC,MAAM,EAAEC,OAAO,CAAC;AAC1D\\\"}\"\n};\nexport function startMapper(worklet) {\n  var inputs = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var outputs = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n  var mapperID = MAPPER_ID += 1;\n  runOnUI(function () {\n    var _e = [new global.Error(), -6, -27];\n    var _f = function _f() {\n      var mapperRegistry = global.__mapperRegistry;\n      if (mapperRegistry === undefined) {\n        mapperRegistry = global.__mapperRegistry = createMapperRegistry();\n      }\n      mapperRegistry.start(mapperID, worklet, inputs, outputs);\n    };\n    _f._closure = {\n      createMapperRegistry: createMapperRegistry,\n      mapperID: mapperID,\n      worklet: worklet,\n      inputs: inputs,\n      outputs: outputs\n    };\n    _f.__initData = _worklet_10884867408878_init_data;\n    _f.__workletHash = 10884867408878;\n    _f.__stackDetails = _e;\n    _f.__version = \"3.3.0\";\n    return _f;\n  }())();\n  return mapperID;\n}\nvar _worklet_13611698491048_init_data = {\n  code: \"function anonymous() {\\n  const {\\n    mapperID\\n  } = this._closure;\\n  const mapperRegistry = global.__mapperRegistry;\\n  mapperRegistry === null || mapperRegistry === void 0 ? void 0 : mapperRegistry.stop(mapperID);\\n}\",\n  location: \"C:\\\\Users\\\\GGPC\\\\Documents\\\\kidsgram-web\\\\node_modules\\\\react-native-reanimated\\\\lib\\\\module\\\\reanimated2\\\\mappers.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"anonymous\\\",\\\"mapperID\\\",\\\"_closure\\\",\\\"mapperRegistry\\\",\\\"global\\\",\\\"__mapperRegistry\\\",\\\"stop\\\"],\\\"sources\\\":[\\\"C:/Users/GGPC/Documents/kidsgram-web/node_modules/react-native-reanimated/lib/module/reanimated2/mappers.js\\\"],\\\"mappings\\\":\\\"AAiLU,SAAAA,SAAMA,CAAA;EAAA;IAAAC;EAAA,SAAAC,QAAA;EACZ,MAAMC,cAAc,GAAGC,MAAM,CAACC,gBAAgB;EAC9CF,cAAc,KAAK,IAAI,IAAIA,cAAc,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,cAAc,CAACG,IAAI,CAACL,QAAQ,CAAC;AAC/F\\\"}\"\n};\nexport function stopMapper(mapperID) {\n  runOnUI(function () {\n    var _e = [new global.Error(), -2, -27];\n    var _f = function _f() {\n      var mapperRegistry = global.__mapperRegistry;\n      mapperRegistry === null || mapperRegistry === void 0 ? void 0 : mapperRegistry.stop(mapperID);\n    };\n    _f._closure = {\n      mapperID: mapperID\n    };\n    _f.__initData = _worklet_13611698491048_init_data;\n    _f.__workletHash = 13611698491048;\n    _f.__stackDetails = _e;\n    _f.__version = \"3.3.0\";\n    return _f;\n  }())();\n}","map":{"version":3,"names":["isJest","runOnUI","isSharedValue","IS_JEST","_worklet_10153940359385_init_data","code","location","sourceMap","createMapperRegistry","_e","global","Error","_f","mappers","Map","sortedMappers","runRequested","processingMappers","updateMappersOrder","pre","forEach","mapper","outputs","_iterator","_createForOfIteratorHelperLoose","_step","done","output","value","preMappers","get","undefined","set","push","visited","Set","newOrder","dfs","add","_iterator2","inputs","_step2","input","_iterator3","_step3","preMapper","has","mapperRun","size","length","_iterator4","_step4","dirty","worklet","maybeRequestUpdates","requestAnimationFrame","queueMicrotask","extractInputs","resultArray","Array","isArray","_iterator5","_step5","Object","getPrototypeOf","prototype","_i","_Object$values","values","element","start","mapperID","id","_iterator6","_step6","sv","addListener","stop","delete","_iterator7","_step7","removeListener","_closure","__initData","__workletHash","__stackDetails","__version","MAPPER_ID","_worklet_10884867408878_init_data","startMapper","arguments","mapperRegistry","__mapperRegistry","_worklet_13611698491048_init_data","stopMapper"],"sources":["C:\\Users\\GGPC\\Documents\\kidsgram-web\\node_modules\\react-native-reanimated\\lib\\module\\reanimated2\\mappers.ts"],"sourcesContent":["import { SharedValue } from './commonTypes';\nimport { isJest } from './PlatformChecker';\nimport { runOnUI } from './threads';\nimport { isSharedValue } from './utils';\n\nconst IS_JEST = isJest();\n\nexport type Mapper = {\n  id: number;\n  dirty: boolean;\n  worklet: () => void;\n  inputs: SharedValue<any>[];\n  outputs?: SharedValue<any>[];\n};\n\nexport function createMapperRegistry() {\n  'worklet';\n  const mappers = new Map();\n  let sortedMappers: Mapper[] = [];\n\n  let runRequested = false;\n  let processingMappers = false;\n\n  function updateMappersOrder() {\n    // sort mappers topologically\n    // the algorithm here takes adventage of a fact that the topological order\n    // of a transposed graph is a reverse topological order of the original graph\n    // The graph in our case consists of mappers and an edge between two mappers\n    // A and B exists if there is a shared value that's on A's output lists and on\n    // B's input list.\n    //\n    // We don't need however to calculate that graph as it is easier to work with\n    // the transposed version of it that can be calculated ad-hoc. For the transposed\n    // version to be traversed we use \"pre\" map that maps share value to mappers that\n    // output that shared value. Then we can infer all the outgoing edges for a given\n    // mapper simply by scanning it's input list and checking if any of the shared values\n    // from that list exists in the \"pre\" map. If they do, then we have an edge between\n    // that mapper and the mappers from the \"pre\" list for the given shared value.\n    //\n    // For topological sorting we use a dfs-based approach that requires the graph to\n    // be traversed in dfs order and each node after being processed lands at the\n    // beginning of the topological order list. Since we traverse a transposed graph,\n    // instead of reversing that order we can use a normal array and push processed\n    // mappers to the end. There is no need to reverse that array after we are done.\n    const pre = new Map(); // map from sv -> mapper that outputs that sv\n    mappers.forEach((mapper) => {\n      if (mapper.outputs) {\n        for (const output of mapper.outputs) {\n          const preMappers = pre.get(output);\n          if (preMappers === undefined) {\n            pre.set(output, [mapper]);\n          } else {\n            preMappers.push(mapper);\n          }\n        }\n      }\n    });\n    const visited = new Set();\n    const newOrder: Mapper[] = [];\n    function dfs(mapper: Mapper) {\n      visited.add(mapper);\n      for (const input of mapper.inputs) {\n        const preMappers = pre.get(input);\n        if (preMappers) {\n          for (const preMapper of preMappers) {\n            if (!visited.has(preMapper)) {\n              dfs(preMapper);\n            }\n          }\n        }\n      }\n      newOrder.push(mapper);\n    }\n    mappers.forEach((mapper) => {\n      if (!visited.has(mapper)) {\n        dfs(mapper);\n      }\n    });\n    sortedMappers = newOrder;\n  }\n\n  function mapperRun() {\n    runRequested = false;\n    if (processingMappers) {\n      return;\n    }\n    processingMappers = true;\n    if (mappers.size !== sortedMappers.length) {\n      updateMappersOrder();\n    }\n    for (const mapper of sortedMappers) {\n      if (mapper.dirty) {\n        mapper.dirty = false;\n        mapper.worklet();\n      }\n    }\n    processingMappers = false;\n  }\n\n  function maybeRequestUpdates() {\n    if (IS_JEST) {\n      // On Jest environment we avoid using queueMicrotask as that'd require test\n      // to advance the clock manually. This on other hand would require tests\n      // to know how many times mappers need to run. As we don't want tests to\n      // make any assumptions on that number it is easier to execute mappers\n      // immediately for testing purposes and only expect test to advance timers\n      // if they want to make any assertions on the effects of animations being run.\n      mapperRun();\n    } else if (!runRequested) {\n      if (processingMappers) {\n        // In general, we should avoid having mappers trigger updates as this may\n        // result in unpredictable behavior. Specifically, the updated value can\n        // be read by mappers that run later in the same frame but previous mappers\n        // would access the old value. Updating mappers during the mapper-run phase\n        // breaks the order in which we should execute the mappers. However, doing\n        // that is still a possibility and there are some instances where people use\n        // the API in that way, hence we need to prevent mapper-run phase falling into\n        // an infinite loop. We do that by detecting when mapper-run is requested while\n        // we are already in mapper-run phase, and in that case we use `requestAnimationFrame`\n        // instead of `queueMicrotask` which will schedule mapper run for the next\n        // frame instead of queuing another set of updates in the same frame.\n        requestAnimationFrame(mapperRun);\n      } else {\n        queueMicrotask(mapperRun);\n      }\n      runRequested = true;\n    }\n  }\n\n  function extractInputs(\n    inputs: any,\n    resultArray: SharedValue<any>[]\n  ): SharedValue<any>[] {\n    if (Array.isArray(inputs)) {\n      for (const input of inputs) {\n        input && extractInputs(input, resultArray);\n      }\n    } else if (isSharedValue(inputs)) {\n      resultArray.push(inputs);\n    } else if (Object.getPrototypeOf(inputs) === Object.prototype) {\n      // we only extract inputs recursively from \"plain\" objects here, if object\n      // is of a derivative class (e.g. HostObject on web, or Map) we don't scan\n      // it recursively\n      for (const element of Object.values(inputs)) {\n        element && extractInputs(element, resultArray);\n      }\n    }\n    return resultArray;\n  }\n\n  return {\n    start: (\n      mapperID: number,\n      worklet: () => void,\n      inputs: SharedValue<any>[],\n      outputs?: SharedValue<any>[]\n    ) => {\n      const mapper = {\n        id: mapperID,\n        dirty: true,\n        worklet,\n        inputs: extractInputs(inputs, []),\n        outputs,\n      };\n      mappers.set(mapper.id, mapper);\n      sortedMappers = [];\n      for (const sv of mapper.inputs) {\n        sv.addListener(mapper.id, () => {\n          mapper.dirty = true;\n          maybeRequestUpdates();\n        });\n      }\n      maybeRequestUpdates();\n    },\n    stop: (mapperID: number) => {\n      const mapper = mappers.get(mapperID);\n      if (mapper) {\n        mappers.delete(mapper.id);\n        sortedMappers = [];\n        for (const sv of mapper.inputs) {\n          sv.removeListener(mapper.id);\n        }\n      }\n    },\n  };\n}\n\nlet MAPPER_ID = 9999;\n\nexport function startMapper(\n  worklet: () => void,\n  inputs: any[] = [],\n  outputs: any[] = []\n): number {\n  const mapperID = (MAPPER_ID += 1);\n\n  runOnUI(() => {\n    let mapperRegistry = global.__mapperRegistry;\n    if (mapperRegistry === undefined) {\n      mapperRegistry = global.__mapperRegistry = createMapperRegistry();\n    }\n    mapperRegistry.start(mapperID, worklet, inputs, outputs);\n  })();\n\n  return mapperID;\n}\n\nexport function stopMapper(mapperID: number): void {\n  runOnUI(() => {\n    const mapperRegistry = global.__mapperRegistry;\n    mapperRegistry?.stop(mapperID);\n  })();\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}