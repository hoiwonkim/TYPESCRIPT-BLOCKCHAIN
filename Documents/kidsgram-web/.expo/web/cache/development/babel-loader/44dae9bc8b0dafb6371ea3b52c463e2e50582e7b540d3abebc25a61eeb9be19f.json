{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _taggedTemplateLiteralLoose from \"@babel/runtime/helpers/taggedTemplateLiteralLoose\";\nvar _templateObject;\nimport Button from \"../components/Button\";\nimport styled from \"styled-components/native\";\nimport AuthLayout from \"../components/AuthLayout\";\nimport { handleLogin } from \"../apollo\";\nimport { Input } from \"../components/shared\";\nimport { useForm, Controller } from \"react-hook-form\";\nimport { useRef } from \"react\";\nimport { useLoginMutation } from \"../generated/graphql\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar Contaienr = styled.View(_templateObject || (_templateObject = _taggedTemplateLiteralLoose([\"\\n  width: 100%;\\n  padding: 0 20px;\\n\"])));\nvar Login = function Login(_ref) {\n  var _route$params, _route$params2;\n  var route = _ref.route;\n  var passwordRef = useRef(null);\n  var _useForm = useForm({\n      defaultValues: {\n        username: (_route$params = route.params) == null ? void 0 : _route$params.username,\n        password: (_route$params2 = route.params) == null ? void 0 : _route$params2.password\n      }\n    }),\n    control = _useForm.control,\n    handleSubmit = _useForm.handleSubmit,\n    getValues = _useForm.getValues,\n    watch = _useForm.watch;\n  var _useLoginMutation = useLoginMutation({\n      onCompleted: function onCompleted(data) {\n        var _data$login = data.login,\n          ok = _data$login.ok,\n          token = _data$login.token;\n        if (ok === true && token) {\n          return handleLogin(token);\n        }\n        return;\n      }\n    }),\n    _useLoginMutation2 = _slicedToArray(_useLoginMutation, 2),\n    loginMutation = _useLoginMutation2[0],\n    loginLoading = _useLoginMutation2[1].loading;\n  var onFocusNext = function onFocusNext(nextRef) {\n    var _nextRef$current;\n    (_nextRef$current = nextRef.current) == null ? void 0 : _nextRef$current.focus();\n  };\n  var onValid = function onValid() {\n    if (loginLoading === true) {\n      return;\n    }\n    var _getValues = getValues(),\n      username = _getValues.username,\n      password = _getValues.password;\n    loginMutation({\n      variables: {\n        username: username,\n        password: password\n      }\n    });\n  };\n  return _jsx(AuthLayout, {\n    children: _jsxs(Contaienr, {\n      children: [_jsx(Controller, {\n        name: \"username\",\n        control: control,\n        rules: {\n          required: true,\n          minLength: 1,\n          maxLength: 20\n        },\n        render: function render(_ref2) {\n          var _ref2$field = _ref2.field,\n            onChange = _ref2$field.onChange,\n            value = _ref2$field.value;\n          return _jsx(Input, {\n            value: value,\n            onChangeText: onChange,\n            onSubmitEditing: function onSubmitEditing() {\n              return onFocusNext(passwordRef);\n            },\n            keyboardType: \"email-address\",\n            autoCapitalize: \"none\",\n            autoCorrect: false,\n            returnKeyType: \"done\",\n            placeholder: \"\\uC720\\uC800 \\uC774\\uB984\",\n            placeholderTextColor: \"gray\",\n            blurOnSubmit: false,\n            maxLength: 20\n          });\n        }\n      }), _jsx(Controller, {\n        name: \"password\",\n        control: control,\n        rules: {\n          required: true,\n          minLength: 1,\n          maxLength: 30\n        },\n        render: function render(_ref3) {\n          var _ref3$field = _ref3.field,\n            onChange = _ref3$field.onChange,\n            value = _ref3$field.value;\n          return _jsx(Input, {\n            value: value,\n            onChangeText: onChange,\n            onSubmitEditing: handleSubmit(onValid),\n            ref: passwordRef,\n            autoCapitalize: \"none\",\n            secureTextEntry: true,\n            placeholder: \"\\uBE44\\uBC00\\uBC88\\uD638\",\n            placeholderTextColor: \"gray\",\n            maxLength: 30\n          });\n        }\n      }), _jsx(Button, {\n        onPress: handleSubmit(onValid),\n        text: \"\\uB85C\\uADF8\\uC778\",\n        size: \"14px\",\n        bgFill: true,\n        loading: loginLoading,\n        disabled: watch(\"username\") === \"\" || watch(\"password\") === \"\"\n      })]\n    })\n  });\n};\nexport default Login;","map":{"version":3,"names":["Button","styled","AuthLayout","handleLogin","Input","useForm","Controller","useRef","useLoginMutation","jsx","_jsx","jsxs","_jsxs","Contaienr","View","_templateObject","_taggedTemplateLiteralLoose","Login","_ref","_route$params","_route$params2","route","passwordRef","_useForm","defaultValues","username","params","password","control","handleSubmit","getValues","watch","_useLoginMutation","onCompleted","data","_data$login","login","ok","token","_useLoginMutation2","_slicedToArray","loginMutation","loginLoading","loading","onFocusNext","nextRef","_nextRef$current","current","focus","onValid","_getValues","variables","children","name","rules","required","minLength","maxLength","render","_ref2","_ref2$field","field","onChange","value","onChangeText","onSubmitEditing","keyboardType","autoCapitalize","autoCorrect","returnKeyType","placeholder","placeholderTextColor","blurOnSubmit","_ref3","_ref3$field","ref","secureTextEntry","onPress","text","size","bgFill","disabled"],"sources":["C:/Users/GGPC/Documents/kidsgram-web/screens/Login.tsx"],"sourcesContent":["import Button from \"../components/Button\";\r\nimport styled from \"styled-components/native\";\r\nimport AuthLayout from \"../components/AuthLayout\";\r\nimport { handleLogin } from \"../apollo\";\r\nimport { Input } from \"../components/shared\";\r\nimport { useForm, Controller } from \"react-hook-form\";\r\nimport { MutableRefObject, RefObject, useRef } from \"react\";\r\nimport { RootStackParamList } from \"../shared/shared.types\";\r\nimport { LoginMutation, useLoginMutation } from \"../generated/graphql\";\r\nimport { NativeStackScreenProps } from \"@react-navigation/native-stack\";\r\n\r\ntype LoginNavigationProps = NativeStackScreenProps<RootStackParamList, \"StackLogin\">;\r\n\r\ninterface LoginFormData {\r\n  username: string;\r\n  password: string;\r\n}\r\n\r\nconst Contaienr = styled.View`\r\n  width: 100%;\r\n  padding: 0 20px;\r\n`;\r\n\r\nconst Login = ({ route }: LoginNavigationProps) => {\r\n  const passwordRef: MutableRefObject<null> = useRef(null);\r\n  const { control, handleSubmit, getValues, watch } = useForm<LoginFormData>({\r\n    defaultValues: { username: route.params?.username, password: route.params?.password },\r\n  });\r\n  const [loginMutation, { loading: loginLoading }] = useLoginMutation({\r\n    onCompleted: (data: LoginMutation) => {\r\n      const {\r\n        login: { ok, token },\r\n      } = data;\r\n\r\n      if (ok === true && token) {\r\n        return handleLogin(token);\r\n      }\r\n      return;\r\n    },\r\n  });\r\n\r\n  const onFocusNext = (nextRef: RefObject<HTMLInputElement>): void => {\r\n    nextRef.current?.focus();\r\n  };\r\n\r\n  const onValid = (): void => {\r\n    if (loginLoading === true) {\r\n      return;\r\n    }\r\n    const { username, password } = getValues();\r\n    loginMutation({ variables: { username, password } });\r\n  };\r\n\r\n  return (\r\n    <AuthLayout>\r\n      <Contaienr>\r\n        <Controller\r\n          name=\"username\"\r\n          control={control}\r\n          rules={{ required: true, minLength: 1, maxLength: 20 }}\r\n          render={({ field: { onChange, value } }) => (\r\n            <Input\r\n              value={value}\r\n              onChangeText={onChange}\r\n              onSubmitEditing={() => onFocusNext(passwordRef)}\r\n              keyboardType=\"email-address\"\r\n              autoCapitalize=\"none\"\r\n              autoCorrect={false}\r\n              returnKeyType=\"done\"\r\n              placeholder=\"유저 이름\"\r\n              placeholderTextColor=\"gray\"\r\n              blurOnSubmit={false}\r\n              maxLength={20}\r\n            ></Input>\r\n          )}\r\n        ></Controller>\r\n        <Controller\r\n          name=\"password\"\r\n          control={control}\r\n          rules={{ required: true, minLength: 1, maxLength: 30 }}\r\n          render={({ field: { onChange, value } }) => (\r\n            <Input\r\n              value={value}\r\n              onChangeText={onChange}\r\n              onSubmitEditing={handleSubmit(onValid)}\r\n              ref={passwordRef}\r\n              autoCapitalize=\"none\"\r\n              secureTextEntry={true}\r\n              placeholder=\"비밀번호\"\r\n              placeholderTextColor=\"gray\"\r\n              maxLength={30}\r\n            ></Input>\r\n          )}\r\n        ></Controller>\r\n        <Button\r\n          onPress={handleSubmit(onValid)}\r\n          text=\"로그인\"\r\n          size=\"14px\"\r\n          bgFill={true}\r\n          loading={loginLoading}\r\n          disabled={watch(\"username\") === \"\" || watch(\"password\") === \"\"}\r\n        ></Button>\r\n      </Contaienr>\r\n    </AuthLayout>\r\n  );\r\n};\r\n\r\nexport default Login;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}